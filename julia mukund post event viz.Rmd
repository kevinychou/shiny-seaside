---
title: "julia mukund post event viz"
author: "JP"
date: "05/09/2021"
output: html_document
---
```{r}
library('readxl')
library(tidyverse)
library(stringr)

```


```{r}
data <- read_excel("C:/Users/julia/OneDrive/Desktop/shiny-seaside/post-event_responses_v2.xlsx")

print(action_kpi_table)

print(biggest_takeaway_kpi_table)
```



```{r}
PostEventPlot <- function(data, varNames) {
  
  title = paste(varNames[1], "Barplot") %>% str_to_title()
  yaxislabel = paste("KPI Percentage") %>% str_to_title()
  if(length(varNames) == 1) {
    # This line fixes it
      
      data = data %>% dplyr::rename(var1 = varNames[[1]])
      xaxislabel = paste(varNames[1])
      legendlabel = paste(varNames[2])
      data  %>% ggplot(aes(x = reorder(var1, var1, function(x)-length(x)))) + geom_bar(fill="skyblue1") + labs(y=str_to_title(yaxislabel), x = str_to_title(xaxislabel)) + ggtitle(sub("_", " ", title))
    }
 
    
  } else {
    # This line fixes it
    data = data %>% dplyr::rename(var1 = varNames[[1]], var2 = varNames[[2]])
    xaxislabel = paste(varNames[1])
    legendlabel = paste(varNames[2])
    data %>% ggplot(aes(x = reorder(var1, var1, function(x)-length(x)), fill = var2)) + 
      geom_bar() + labs(y= str_to_title(yaxislabel), x = str_to_title(sub("_", " ", xaxislabel)))+labs(fill=legendlabel)+
      ggtitle(sub("_", " ", title)) + 
        theme(plot.title=element_text(hjust=0.5)) +
        theme(axis.text.x = element_text(angle = 45, vjust = 0.5)) +
        theme_minimal()
    
  }
  
  
}
```

